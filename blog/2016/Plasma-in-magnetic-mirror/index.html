<!DOCTYPE html>
<html lang="en">

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Jue  Xu


  | Plasma-in-Magnetic-Mirror

</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🔥</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="https://jue-xu.github.io/blog/2016/Plasma-in-magnetic-mirror/">


<!-- Dark Mode -->
<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://jue-xu.github.io/">
       <span class="font-weight-bold">Jue</span>   Xu
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      





<div class="post">

  <header class="post-header">
    <h1 class="post-title">Plasma-in-Magnetic-Mirror</h1>
    <p class="post-meta">March 14, 2016</p>
    <p class="post-tags">
      <a href="/blog/2016"> <i class="fas fa-calendar fa-sm"></i> 2016 </a>
      
        ·  
        
        <a href="/blog/tag/project">
          <i class="fas fa-hashtag fa-sm"></i> project</a>  
          
      

      
        ·  
        
        <a href="/blog/category/Blog">
          <i class="fas fa-tag fa-sm"></i> Blog</a>  
          
      

    </p>
  </header>

  <article class="post-content">
    <h2 id="principle-of-magnetic-bottle"><a href="https://en.wikipedia.org/wiki/Magnetic_mirror" target="_blank" rel="noopener noreferrer">Principle of Magnetic Bottle</a></h2>
<p>A magnetic bottle is two magnetic mirrors placed close together. For example, two parallel coils separated by a small distance, carrying the same current in the same direction will produce a magnetic bottle between them. Unlike the full mirror machine which typically had many large rings of current surrounding the middle of the magnetic field, the bottle typically has just two rings of current. Particles near either end of the bottle experience a magnetic force towards the center of the region; particles with appropriate speeds spiral repeatedly from one end of the region to the other and back. Magnetic bottles can be used to temporarily trap charged particles. It is easier to trap electrons than ions, because electrons are so much lighter This technique is used to confine very hot plasmas with temperatures of the order of 106 K.</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/1/1e/Fields_in_magnetic_bottles.jpg" alt="magnetic mirror"></p>

<hr>

<h2 id="how-to-simulate-a-magnetic-bottle">How to simulate a Magnetic Bottle</h2>
<blockquote>
  <p><a href="https://github.com/JackXu1993/Plasma_in_magnetic_mirror/blob/master/latex/assignment2.pdf" target="_blank" rel="noopener noreferrer">The math equations below are written by latex. You can see a more concise version here</a></p>
</blockquote>

<h3 id="calculate-the-magnetic-field-of-magnetic-bottle-in-3d-by-numeric-integration">Calculate the magnetic field of magnetic bottle in 3D by numeric integration</h3>
<p>We can get the magnetic field which is generared by a coil(at the origin of the coordinate) by integrating</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\begin{equation}
\begin{cases}
        B_{x0}(x,y,z)=\int_0^{2 \pi} \frac{Rzcos \phi}{(x^2+y^2+z^2+R^2-2xRcos \phi-2yRsin \phi)^{3/2}} d\phi\\
        B_{y0}(x,y,z)=\int_0^{2 \pi} \frac{Rzsin \phi}{(x^2+y^2+z^2+R^2-2xRcos \phi-2yRsin \phi)^{3/2}} d\phi\\
        B_{z0}(x,y,z)=\int_0^{2 \pi} \frac{R(R-xcos\phi-ysin\phi)}{(x^2+y^2+z^2+R^2-2xRcos \phi-2yRsin \phi)^{3/2}} d\phi
\end{cases}
\end{equation}
</code></pre></div></div>

<p>Then we can get the magnetic field of a magnetic bottle (two coils) by a transformation</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> \begin{equation}
 \begin{cases}
        B_{x}(x,y,z)=B_{x0}(x,y,z-d/2)+B_{x0}(x,y,z+d/2)\\
        B_{y}(x,y,z)=B_{y0}(x,y,z-d/2)+B_{y0}(x,y,z+d/2)\\
        B_{z}(x,y,z)=B_{z0}(x,y,z-d/2)+B_{z0}(x,y,z+d/2)
 \end{cases}
 \end{equation}
</code></pre></div></div>

<p>d in these equations means the distance between two coils.</p>

<h3 id="calculate-the-trace-of-an-electron-in-a-magnetic-bottle-by-solving-odesnewton-equation-and-lorentz-force">Calculate the trace of an electron in a magnetic bottle by solving odes(newton equation and Lorentz force)</h3>
<p>According to the Newton equation and Lorentz force equation</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\begin{equation}
\begin{cases}
    F=ma\\
    F_{Lorentz}=qv \times x
\end{cases}
\end{equation}
</code></pre></div></div>

<p>Then we can get the equation,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\begin{equation}
    qv \times x=ma
\end{equation}
</code></pre></div></div>

<p>Then we need to solve the second order Ordinary Diﬀerential Equations, because we study this problem in 3D.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\begin{equation}
    \begin{cases}
        x''=-\frac{m}{q}(y'Bz(x,y,z)-z'By(x,y,z))\\
        y''=-\frac{m}{q}(z'Bx(x,y,z)-x'Bz(x,y,z))\\
        z''=-\frac{m}{q}(x'By(x,y,z)-y'Bx(x,y,z))
    \end{cases}
\end{equation}
</code></pre></div></div>

<p>We transfer the them into first order Ordinary Diﬀerential Equations,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\begin{equation}
    \begin{cases}
        vx'=-sc(vy*Bz(x,y,z)-vz*By(x,y,z))\\
        vy'=-sc(vz*Bx(x,y,z)-vx*Bz(x,y,z))\\
        vz'=-sc(vx*By(x,y,z)-vy*Bx(x,y,z))\\
        x'=vx\\
        y'=vy\\
        z'=vz
    \end{cases}
\end{equation}
</code></pre></div></div>

<p>Its intial values are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\begin{equation}
    \begin{cases}
        vx(0)=0\\
        vy(0)=0\\
        vz(0)=0.15e6\\
        x(0)=0\\
        y(0)=0.78R\\
        z(0)=-0.75d
    \end{cases}
\end{equation}
</code></pre></div></div>

<hr>

<h2 id="code-by-mathematica"><a href="https://github.com/JackXu1993/Plasma_in_magnetic_mirror/blob/master/magnetic_mirror(mathematica_code).nb" target="_blank" rel="noopener noreferrer">Code by Mathematica</a></h2>
<p>Mathematica is a powerful mathematic and physics software. It can realize this program by very short code and its graphics in 3D and animation in 3D are cool, but its efficiency is really low.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SetDirectory[NotebookDirectory[]];

Bx0[x_, y_, z_] := NIntegrate[
   ( R z Cos[\[CurlyPhi]])/(x^2 + y^2 + z^2 + R^2 -
     2 x R Cos[\[CurlyPhi]] - 2 y R Sin[\[CurlyPhi]])^(3/2),
   {\[CurlyPhi], 0, 2 \[Pi]}, MaxRecursion -&gt; 12];
By0[x_, y_, z_] := NIntegrate[
   ( R z Sin[\[CurlyPhi]])/(x^2 + y^2 + z^2 + R^2 -
     2 x R Cos[\[CurlyPhi]] - 2 y R Sin[\[CurlyPhi]])^(3/2),
   {\[CurlyPhi], 0, 2 \[Pi]}, MaxRecursion -&gt; 12];
Bz0[x_, y_, z_] := NIntegrate[
   ( R (R - x Cos[\[CurlyPhi]] - y Sin[\[CurlyPhi]]))/(x^2 + y^2 +
     z^2 + R^2 - 2 x R Cos[\[CurlyPhi]] - 2 y R Sin[\[CurlyPhi]])^(
   3/2),
   {\[CurlyPhi], 0, 2 \[Pi]}, MaxRecursion -&gt; 12];
Bx[x_, y_, z_] := Bx0[x, y, z - d/2] + Bx0[x, y, z + d/2];
By[x_, y_, z_] := By0[x, y, z - d/2] + By0[x, y, z + d/2];
Bz[x_, y_, z_] := Bz0[x, y, z - d/2] + Bz0[x, y, z + d/2];
R = 1.0; d = 2 R; n = 50;
data1 = {};
Do[
 Do[
  Do[AppendTo[data1, {(3 R)/n i, (3 R)/n j, (2 d)/n k,
     Bx[(3 R)/n i, (3 R)/n j, (2 d)/n k]}],
   {i, -n/2, n/2}],
  {j, -n/2, n/2}],
 {k, -n/2, n/2}]
Bx = Interpolation[data1];
Bx &gt;&gt; "Bx50";
data2 = {};
Do[
 Do[
  Do[AppendTo[data2, {(3 R)/n i, (3 R)/n j, (2 d)/n k,
     By[(3 R)/n i, (3 R)/n j, (2 d)/n k]}],
   {i, -n/2, n/2}],
  {j, -n/2, n/2}],
 {k, -n/2, n/2}]
By = Interpolation[data2];
By &gt;&gt; "By50";
data3 = {};
Do[
 Do[
  Do[AppendTo[data3, {(3 R)/n i, (3 R)/n j, (2 d)/n k,
     Bz[(3 R)/n i, (3 R)/n j, (2 d)/n k]}],
   {i, -n/2, n/2}],
  {j, -n/2, n/2}],
 {k, -n/2, n/2}]
Bz = Interpolation[data3];
Bz &gt;&gt; "Bz50";

SetDirectory[NotebookDirectory[]];
R = 1; d = 2 R;
sc = 1.75851*10^11*0.35*10^-5; time = 60 10^-6;
&lt;&lt; "Bx50";
Bx = %;
&lt;&lt; "By50";
By = %;
&lt;&lt; "Bz50";
Bz = %;
equ = {x''[t] == -sc (y'[t] Bz[x[t], y[t], z[t]] -
       z'[t] By[x[t], y[t], z[t]]),
   y''[t] == -sc (z'[t] Bx[x[t], y[t], z[t]] -
       x'[t] Bz[x[t], y[t], z[t]]),
   z''[t] == -sc (x'[t] By[x[t], y[t], z[t]] -
       y'[t] Bx[x[t], y[t], z[t]]),
   x[0] == 0, x'[0] == 0, y[0] == 0, y'[0] == 0.3 10^6,
   z[0] == 0, z'[0] == 0.15 10^6};
s = NDSolve[equ, {x, y, z}, {t, 0, time}]
{x, y, z} = {x, y, z} /. s[[1]];
Manipulate[ParametricPlot3D[{x[t], y[t], z[t]},
  {t, 0, t0}, Ticks -&gt; None, AxesStyle -&gt; Thin, Axes -&gt; True,
  AxesLabel -&gt; {"x", "y", "z"},
  PlotStyle -&gt; {Thin, Black}, AspectRatio -&gt; 2]
</code></pre></div></div>
<p>This picture shows the configuration of a magnetic bottle. The grey vectors represent the magnetic field. Two yellow rings means two coils with the same current. Red lines presents the trace of an electron. The blue arrow means the initial position and velocity of the electron.</p>

<p><img src="http://ww1.sinaimg.cn/large/0062cUvtgw1f03rwzk2z4j30pz0pen2x.jpg" alt="Magnetic Field"></p>

<p>This gif shows the movement of an electron in a magnetic bottle.(Notice the two coils actually are on the z axle, which is different from the picture above. You can see this gif by rotating your head by 90 degree)</p>

<p><img src="http://ww3.sinaimg.cn/large/0062cUvtgw1f03md0p7z1g306s0c07el.gif" alt="Drift"></p>

<p>This figure shows the x,y,z coordinate changing with time.</p>

<p><img src="https://raw.githubusercontent.com/JackXu1993/Plasma_in_magnetic_mirror/master/Untitled-1.bmp" alt="xyz"></p>

<hr>

<h2 id="code-by-c-and-opengl"><a href="https://github.com/JackXu1993/Plasma_in_magnetic_mirror/blob/master/plasma.cpp" target="_blank" rel="noopener noreferrer">Code by C and OpenGL</a></h2>
<p>Although C is much more complicate than Mathematica and its code is much longer, its efficiency is much higher and OpenGl is good at graphics and animation.</p>

<p>This figure shows the x,y,z coordinate changing with time, which is almost same to the one calculated by Mathematica.</p>

<p><img src="https://raw.githubusercontent.com/JackXu1993/Plasma_in_magnetic_mirror/master/cxyz.png" alt="figure"></p>

<h4 id="preview">Preview</h4>

<p><img src="https://raw.githubusercontent.com/JackXu1993/Plasma_in_magnetic_mirror/master/magnetic_mirror.gif" alt="C"></p>

<h4 id="settings">Settings</h4>

<h5 id="run-the-program">Run the program</h5>

<ul>
  <li>double click the magnetic_mirror.exe (do not delete the “glut.lib”,”glut.h”,etc in the folder)</li>
  <li>input the initial values</li>
  <li>press ‘a’ to start the animation in the ‘plasma’ window (not the terminal window)</li>
  <li>press ‘s’ to stop the animation</li>
  <li>press the left button and drag it to change the view</li>
</ul>

<h4 id="parameters-can-be-changed">Parameters can be changed</h4>

<p>In this program, you can input the ratio of velocity y and velocity z in the terminal window. When this ratio is too small(i.e ratio&lt;1), the electron will escape from the magnetic mirror. Actually, many parameters can be changed. For instance, the initial velocity and position of the electron can also be changed, which will cause different electron trace. You even can change the configuration of the magnetic mirror (i.e the ratio of the distance of the two coils and the radius of the coil), which can change the magnetic field line and the trace. However, I fix these parameters in case the parameters you input do not have correct physical meanings.</p>

<hr>

<h2 id="matlab">Matlab</h2>

  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    © Copyright 2022 Jue  Xu.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

    
    
    Last updated: December 04, 2022.
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  





</html>
